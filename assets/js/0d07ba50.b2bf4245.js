"use strict";(self.webpackChunkopm_documentation=self.webpackChunkopm_documentation||[]).push([[9905],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>m});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(t),p=o,m=u["".concat(s,".").concat(p)]||u[p]||h[p]||a;return t?r.createElement(m,l(l({ref:n},d),{},{components:t})):r.createElement(m,l({ref:n},d))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,l=new Array(a);l[0]=p;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[u]="string"==typeof e?e:o,l[1]=i;for(var c=2;c<a;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},5758:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=t(7462),o=(t(7294),t(3905));const a={},l="Removal of JQuery Functions",i={unversionedId:"pink-currents/adr/removal-of-jquery",id:"pink-currents/adr/removal-of-jquery",title:"Removal of JQuery Functions",description:"* Status: Completed",source:"@site/docs/pink-currents/adr/removal-of-jquery.md",sourceDirName:"pink-currents/adr",slug:"/pink-currents/adr/removal-of-jquery",permalink:"/docs/pink-currents/adr/removal-of-jquery",draft:!1,editUrl:"https://github.com/Other-People-UCSD/docs/tree/main/docs/pink-currents/adr/removal-of-jquery.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Adding Jekyll SEO Plugins",permalink:"/docs/pink-currents/adr/jekyll-seo-plugins"},next:{title:"Image Compression",permalink:"/docs/pink-currents/thumbnails/"}},s={},c=[{value:"Context and Problem Statement",id:"context-and-problem-statement",level:2},{value:"Decision Drivers",id:"decision-drivers",level:2},{value:"Solution",id:"solution",level:2},{value:"1. Changing the theme from light to dark for the homepage.",id:"1-changing-the-theme-from-light-to-dark-for-the-homepage",level:2},{value:"2. Inline legacy JQuery scripts inside the <code>_includes/header.html</code> file.",id:"2-inline-legacy-jquery-scripts-inside-the-_includesheaderhtml-file",level:2},{value:"3. Legacy Mobile Nav Search Placeholder JQuery as written by Eunsoo.",id:"3-legacy-mobile-nav-search-placeholder-jquery-as-written-by-eunsoo",level:2},{value:"4. javaScrollStudy.html",id:"4-javascrollstudyhtml",level:3}],d={toc:c},u="wrapper";function h(e){let{components:n,...t}=e;return(0,o.kt)(u,(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"removal-of-jquery-functions"},"Removal of JQuery Functions"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Status: Completed"),(0,o.kt)("li",{parentName:"ul"},"Author: Kevin Jang"),(0,o.kt)("li",{parentName:"ul"},"Deciders: Kevin Jang"),(0,o.kt)("li",{parentName:"ul"},"Date: March 20, 2023")),(0,o.kt)("h2",{id:"context-and-problem-statement"},"Context and Problem Statement"),(0,o.kt)("p",null,"Much of the scripted code for this publishing website is reused on almost every page, rendering functions such as style changes and navigation as working. However, is the added overhead or dependencies necessary? Can performance be optimized even more?"),(0,o.kt)("h2",{id:"decision-drivers"},"Decision Drivers"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Updating: The script that imports JQuery is used by specific versions, so some older versions may contain security vulnerabilities that are fixed in newer versions. "),(0,o.kt)("li",{parentName:"ul"},"Security: Less dependencies means that there are less areas for vulnerabilities beyond our control.")),(0,o.kt)("h2",{id:"solution"},"Solution"),(0,o.kt)("p",null,"There are only four sections where JQuery has been used in the repository. In addition, there are only a few JQuery library functions used which does not justify keeping this entire library reference. Instead, vanilla Javascript attributes and functions can still do the same with less overhead connecting to the external server that the JQuery script is run from."),(0,o.kt)("h2",{id:"1-changing-the-theme-from-light-to-dark-for-the-homepage"},"1. Changing the theme from light to dark for the homepage."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Code author: Eunsoo")),(0,o.kt)("p",null,"To convert this to vanilla Javascript, set a scroll event listener onto the window and then get the client's window attributes for offsets. Then use the built-in setAttribute method to assign the css to each element specified by query selectors."),(0,o.kt)("p",null,"In addition, the blocks inside the conditional statement can be reused for theme-changing, so it is best to create a new function where the theme styles change. Refer to ",(0,o.kt)("inlineCode",{parentName:"p"},"assets/js/bgTheme.js")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'$(window).scroll(function () {\n    var wScroll = $(this).scrollTop();\n    if (wScroll >= $(\'.w2b\').offset().top - ($(window).height() / 3.5)) {\n        $("body").css("background-color", "var(--light-text-color)");\n        $("body").css("color", "var(var(--background-color))");\n        $(".logoOutline").css("stroke", "var(var(--background-color))"); \n        $("#logo").css("fill", "var(var(--background-color))");\n        $("header").css("background-color", "var(--light-text-color)");\n        $("header").css("color", "var(var(--background-color))");\n        $(".posts").css("border-color", "var(var(--background-color))");\n    } else {\n        $("body").css("background-color", "var(var(--background-color))");\n        $("body").css("color", "var(--light-text-color)");\n        $(".logoOutline").css("stroke", "var(--light-text-color)");\n        $("#logo").css("fill", "var(--light-text-color)");\n        $("header").css("background-color", "var(var(--background-color))");\n        $("header").css("color", "var(--light-text-color)");\n        $(".posts").css("border-color", "var(--light-text-color)");\n    }\n});\n')),(0,o.kt)("h2",{id:"2-inline-legacy-jquery-scripts-inside-the-_includesheaderhtml-file"},"2. Inline legacy JQuery scripts inside the ",(0,o.kt)("inlineCode",{parentName:"h2"},"_includes/header.html")," file."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Code authors: Eunsoo, Kevin")),(0,o.kt)("p",null,"Again, add the scroll event listener and find offsets of the DOM elements based on the window. Put this inline script into its own Javascript file called ",(0,o.kt)("inlineCode",{parentName:"p"},"assets/js/header.js")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<script>\n    // Hide Header on on scroll down\n    var didScroll;\n    var lastScrollTop = 0;\n    var delta = 5;\n    var navbarHeight = $('header').outerHeight();\n\n    $(window).scroll(function (event) {\n        didScroll = true;\n    });\n\n    setInterval(function () {\n        if (didScroll) {\n            hasScrolled();\n            didScroll = false;\n        }\n    }, 250);\n\n    function hasScrolled() {\n        var st = $(this).scrollTop();\n\n        // Make sure they scroll more than delta\n        if (Math.abs(lastScrollTop - st) <= delta)\n            return;\n\n        // If they scrolled down and are past the navbar, add class .nav-up.\n        // This is necessary so you never see what is \"behind\" the navbar.\n        if (st > lastScrollTop && st > navbarHeight) {\n            // Scroll Down\n            $('header')\n                .removeClass('nav-down')\n                .addClass('nav-up');\n        } else {\n            // Scroll Up\n            if (st + $(window).height() < $(document).height()) {\n                $('header')\n                    .removeClass('nav-up')\n                    .addClass('nav-down');\n            }\n        }\n\n        lastScrollTop = st;\n    }\n<\/script>\n\n<script>\n    function openNav() {\n        document\n            .getElementById(\"myNav\")\n            .style\n            // .display = 'block';\n            .height = \"100%\";\n        document.getElementById('navContent').classList.remove('hidden');\n    }\n\n    function closeNav() {\n        document\n            .getElementById(\"myNav\")\n            .style\n            // .display = 'none';\n            .height = \"0%\";\n        document.getElementById('navContent').classList.add('hidden');\n    }\n<\/script>\n")),(0,o.kt)("h2",{id:"3-legacy-mobile-nav-search-placeholder-jquery-as-written-by-eunsoo"},"3. Legacy Mobile Nav Search Placeholder JQuery as written by Eunsoo."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Code author: Eunsoo")),(0,o.kt)("p",null,"This is also put into the ",(0,o.kt)("inlineCode",{parentName:"p"},"assets/js/header.js")," because the mobile navigation is always included in the header via ",(0,o.kt)("inlineCode",{parentName:"p"},"_includes/headerMain.html"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<script>\n    $('#search-input')\n        .focus(function () {\n            $(this).attr('placeholder', '')\n        })\n        .blur(function () {\n            $(this).attr('placeholder', 'Search')\n        })\n<\/script>\n\n<script>\n    $('#search-input').keyup(function (event) {\n        if (event.which === 13) {\n            $(this).blur();\n        }\n    });\n<\/script>\n")),(0,o.kt)("h3",{id:"4-javascrollstudyhtml"},"4. javaScrollStudy.html"),(0,o.kt)("p",null,"There was also another file in the _includes folder called ",(0,o.kt)("inlineCode",{parentName:"p"},"javaScrollStudy.html"),". This was never touched when Kevin took over the website and a quick grep over the codebase revealed that this file was never being used anywhere. As it appears to make the screen scroll down for a little bit, it may have been used to debug the dark theme change on the homepage. However, as it has no use in the present project, it can be safely removed. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<script>\n    window.smoothScroll = function (target) {\n        var scrollContainer = target;\n        do { //find scroll container\n            scrollContainer = scrollContainer.parentNode;\n            if (!scrollContainer)\n                return;\n            scrollContainer.scrollTop += 1;\n        } while (scrollContainer.scrollTop == 0);\n\n        var targetY = 0;\n        do { //find the top of target relatively to the container\n            if (target == scrollContainer)\n                break;\n            targetY += target.offsetTop;\n        } while (target = target.offsetParent);\n\n        scroll = function (c, a, b, i) {\n            i++;\n            if (i > 10)\n                return;\n            c.scrollTop = a + (b - a) / 10 * i;\n            setTimeout(function () {\n                scroll(c, a, b, i);\n            }, 20);\n        }\n        // start scrolling\n        scroll(scrollContainer, scrollContainer.scrollTop, targetY, 0);\n    }\n<\/script>\n")))}h.isMDXComponent=!0}}]);